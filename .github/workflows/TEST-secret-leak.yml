name: TEST - Secret Leak to PR
on: [workflow_dispatch]

permissions:
  contents: write
  pull-requests: write

jobs:
  test-leak:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Simulate token generation (like real workflow)
        run: |
          echo "SIMULATED_TOKEN=ghs_fake_token_for_testing" >> $GITHUB_ENV
          
      - name: Create PR with potential leak
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "Test PR for secret leak research"
          title: "Test: Check for secret exposure"
          body: |
            This is a test PR to check if secrets leak.
            
            Normally workflows might output tokens here.
            Example: Token was ${{ env.SIMULATED_TOKEN }}
            
            Security research for Grafana bug bounty.
          branch: test-secret-leak-${{ github.run_id }}
          delete-branch: true
